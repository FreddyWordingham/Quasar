<style>
    .widget.command {
        position: absolute;
        top: 100%;
        left: 50%;
        transform: translate(-50%, -100%);
        width: 80%;
    }

    .content.command {
        overflow: hidden !important;
    }
</style>

<div class="input-group">
    <input
        id="command-console"
        type="text"
        class="form-control"
        placeholder="Command line interface"
        onkeyup="$command.process_keystroke(event)"
    />
    <button
        id="command-submit"
        type="button"
        class="btn btn-primary"
        onclick="$command.submit()"
    >
        Submit
    </button>
</div>
<hr />
<div class="row">
    <div class="col-sm-6">
        <textarea id="command-input" class="form-control" rows="5" disabled>
Input</textarea
        >
    </div>
    <div class="col-sm-6">
        <textarea id="command-output" class="form-control" rows="5" disabled>
Output</textarea
        >
    </div>
</div>

<script>
    $command = {
        process_keystroke: function (event) {
            if (event.keyCode === 13) {
                $("#command-submit").click();
            }
        },

        submit: function () {
            let command = $("#command-console").val();

            $.ajax({
                url: "/session/id/" + $session_id + "/write",
                type: "post",
                contentType: "application/json",
                data: JSON.stringify({
                    command: command,
                }),
                success: function (response) {
                    $("#command-console").val("");
                },
                error: function () {
                    console.log("error");
                },
            });
        },
    };

    $(document).ready(function () {
        setInterval(function () {
            $.get(
                "/session/id/" + $session_id + "/log/input",
                {},
                function (response) {
                    $("#command-input")
                        .val(response)
                        .scrollTop($("#command-input").height());
                }
            );

            $.get(
                "/session/id/" + $session_id + "/log/output",
                {},
                function (response) {
                    $("#command-output")
                        .val(response)
                        .scrollTop($("#command-output").height());
                }
            );
        }, 1000);
    });
</script>
